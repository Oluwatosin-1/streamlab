{% extends "base.html" %}
{% block content %}
<div class="container my-4">
  <h2>Connect {{ platform|title }} Account</h2>

  {# Optional platform icons or doc links #}
  {% if platform == "youtube" %}
    <div class="alert alert-info my-3">
      If you prefer **OAuth** for YouTube, use our “Connect with Google” flow.<br>
      <strong>Manual Entry:</strong> Retrieve your YouTube <em>RTMP URL & Stream Key</em> from YouTube Studio 
      (YouTube Studio → “Go Live” → “Stream” tab).
    </div>
  {% elif platform == "facebook" %}
    <div class="alert alert-info my-3">
      If you prefer **OAuth** for Facebook, use the “Connect with Facebook” flow.<br>
      <strong>Manual Entry:</strong> Retrieve the <em>RTMP URL & Stream Key</em> from the Facebook Live Producer page.
    </div>
  {% elif platform == "twitch" %}
    <div class="alert alert-info my-3">
      Retrieve your Twitch <em>Stream Key</em> from Creator Dashboard → Settings → Stream.
    </div>
  {% elif platform == "instagram" %}
    <div class="alert alert-warning my-3">
      Instagram typically requires ephemeral keys from 3rd-party solutions, as official usage changes often.
    </div>
  {% elif platform == "telegram" %}
    <div class="alert alert-warning my-3">
      Telegram requires a special RTMP address & key from <a href="https://core.telegram.org/live#rtmp" target="_blank">Telegram docs</a>.
    </div>
  {% elif platform == "tiktok" %}
    <div class="alert alert-warning my-3">
      Tiktok often requires a custom RTMP link and ephemeral key from your live portal.
    </div>
  {% endif %}

  <p class="mt-3">
    Please enter the <strong>RTMP URL</strong> and <strong>Stream Key</strong> below, 
    or use our OAuth flow if available (YouTube/Facebook).
  </p>

  <div class="card p-3">
    <form method="POST">
      {% csrf_token %}
      
      <div class="mb-3">
        <label class="form-label">Display Name</label>
        <input 
          type="text" 
          name="display_name" 
          class="form-control"
          value="{{ social_account.display_name|default_if_none:'' }}"
          placeholder="e.g. My YouTube Channel or My Twitch Stream"
        >
      </div>

      <div class="mb-3">
        <label class="form-label">RTMP URL</label>
        <input 
          type="text" 
          name="rtmp_url" 
          class="form-control"
          value="{{ social_account.rtmp_url|default_if_none:'' }}"
          placeholder="e.g. rtmp://a.rtmp.youtube.com/live2 or rtmp://live-api-s.facebook.com/rtmp/..."
        >
      </div>

      <div class="mb-3">
        <label class="form-label">Stream Key</label>
        <input 
          type="text" 
          name="stream_key" 
          class="form-control"
          value="{{ social_account.stream_key|default_if_none:'' }}"
          placeholder="Paste your stream key here"
        >
      </div>

      <button type="submit" class="btn btn-primary">
        Connect {{ platform|title }}
      </button>
    </form>
  </div>

  {% if social_account.access_token or social_account.stream_key %}
  <div class="alert alert-info mt-4">
    <strong>{{ platform|title }} is currently connected!</strong>
    {% if social_account.rtmp_url %}
      <p>RTMP URL: {{ social_account.rtmp_url }}</p>
    {% endif %}
    {% if social_account.stream_key %}
      <p>Stream Key: {{ social_account.stream_key }}</p>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endblock %}
